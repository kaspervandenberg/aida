X-Spam-Checker-Version: SpamAssassin 3.2.1 (2007-05-02) on imap.science.uva.nl
X-Spam-Status: No, hits=0.3, required=5.0, tests=TW_IJ,TW_JK,TW_LP,TW_UW_FNWI_
X-Spam-Rating: O
Received: from pony.ic.uva.nl [145.18.40.181]
          by imap.science.uva.nl with ESMTP (sendmail 8.13.8/config 11.38).
          id m337KPCo032570; Thu, 3 Apr 2008 09:20:25 +0200
Received: from cmbi2.cmbi.ru.nl (cmbi2.cmbi.ru.nl [131.174.88.32])
	by pony.ic.uva.nl (8.13.1/8.13.1) with ESMTP id m337KKjr005172
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO);
	Thu, 3 Apr 2008 09:20:21 +0200
Received: from [131.174.146.64] (zuinig.cmbi.umcn.nl [131.174.146.64])
	(authenticated bits=0)
	by cmbi2.cmbi.ru.nl (8.12.11.20060308/8.12.11) with ESMTP id m337K4dl022029
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO);
	Thu, 3 Apr 2008 09:20:04 +0200
Message-ID: <47F48525.7090206@cmbi.ru.nl>
Date: Thu, 03 Apr 2008 09:20:05 +0200
From: "Maarten L. Hekkelman" <m.hekkelman@cmbi.ru.nl>
User-Agent: Thunderbird 2.0.0.12 (X11/20080227)
MIME-Version: 1.0
To: Marco Roos <roos@science.uva.nl>
CC: "M. van Driel" <marc.van.driel@nbic.nl>,
        "M. Scott Marshall" <marshall@science.uva.nl>
Subject: Re: MRS services
References: <ED1D235303A01E45BD7CFDB5C9E648700AEA33@exch.cmbi.kun.nl> <47F391F8.90007@science.uva.nl> <ED1D235303A01E45BD7CFDB5C9E648700AEA3A@exch.cmbi.kun.nl> <47F3A4BD.2070206@science.uva.nl>
In-Reply-To: <47F3A4BD.2070206@science.uva.nl>
Content-Type: multipart/mixed;
 boundary="------------080603050909070902010804"
X-CMBI-MailScanner-Information: Please contact the ISP for more information
X-CMBI-MailScanner: Found to be clean
X-CMBI-MailScanner-SpamCheck: not spam (whitelisted),
	SpamAssassin (score=-1.3, required 6, autolearn=not spam, AWL 1.30,
	BAYES_00 -2.60)
X-MailScanner-From: m.hekkelman@cmbi.ru.nl
X-Canit-CHI2: 0.00
X-Bayes-Prob: 0.0001 (Score 0, tokens from: @@RPTN, default)
X-CanItPRO-Stream: default
X-Canit-Stats-ID: 2000189 - 30c006ce6e40 (trained as not-spam)
X-Scanned-By: CanIt (www . roaringpenguin . com) on 145.18.40.181
X-Virus-Scanned: by amavisd-new

This is a multi-part message in MIME format.
--------------080603050909070902010804
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit

Marco Roos schreef:
> Dag Maarten (en Marc),
> 
> Marc heeft ons je web services doorgestuurd. Hartstikke mooi dat je web 
> services maakt voor MRS. Ik wil ze wel een keer uitproberen in Taverna 
> (een workflow tool voor zover je dat niet al wist). Daarvoor is iets 
> meer documentatie nodig denk ik. Zo zie ik 'parameters' als input, en 
> dan wordt het moeilijk. Heb je iets aan documentatie voor je services? 
> De prettigste documentatie vind ik altijd voorbeelden.
> 
> Zoals je hieronder ziet is een medewerker van Antoine bezig Taverna te 
> leren kennen. Als test-case wilde ze onder andere iets blasten.
> Misschien dat ze dat ook met jouw services zou kunnen, als je dat leuk 
> vindt. (Angela Luijf <a.c.luyf@amc.uva.nl>)


Als je wil weten hoe de webservice echt werkt kun je het beste even de 
source code van MRS downloaden. Link staat op mrs homepage 
(http://mrs.cmbi.ru.nl/) In de directories 
mrs/ws/{search,blast,clustal}/Sources vind je de 
mrsws-{search,blast,clustal}.h files die de interface definiëren, ze 
zijn pseudo .h files die weer door gSoap's compiler heen gehaald worden.

De 'input' parameter kun je in taverna met behulp van de XML splitter 
uiteen rafelen. Dan zul je zien dat er meer dan één input parameter is.

Ik heb een voorbeeld taverna script bijgevoegd. Ik denk dat die moet 
werken, zelf krijg ik momenteel taverna niet aan de praat maar een 
collega van mij heeft 'm gemaakt.

Hopelijk kunnen jullie hier wat verder mee komen.

-maarten

> M. van Driel wrote:
>> Marco,
>>
>> Ik ben niet op de hoogte van de documentatie die erbij zit, maar Maarten
>> (zie CC) weet daar alles van. Voor Angela lijkt me dat een prima
>> oplossing. Dit is wel een MRS blast en geen NCBI blast implementatie, en
>> ik weet dus niet wat Angela hiermee wil.
>>
>> Groet,
>>
>> 	Marc
>>
>> -----Original Message-----
>> From: Marco Roos [mailto:roos@science.uva.nl] 
>> Sent: woensdag 2 april 2008 16:03
>> To: M. van Driel
>> Cc: M. Scott Marshall
>> Subject: Re: MRS services
>>
>> Dag Marc,
>>
>> Is er nog meer documentatie bij? Ik ben wel alvast bij dat 'fetch 
>> descriptions' wat oplevert in Taverna. Ik ben niet zo'n blaster dus 
>> 'parameters' als input zegt me niet zoveel.
>>
>> Het meest behulpzaam vind ik altijd voorbeeld input.
>>
>> Angela in Antoine zijn groep experimenteert nu met Taverna, o.a. wil zij
>>
>> een blast doen. Wellicht leuk om dit ook aan haar door te geven? (Angela
>>
>> Luijf <a.c.luyf@amc.uva.nl>)
>>
>> Groeten,
>> Marco.
>>
>>
>> M. van Driel wrote:
>>   
>>> Marco,
>>>
>>>  
>>>
>>> Nog over MRS, wat is des tijds heb genoemd: Maarten heeft WSDLs 
>>> gemaakt voor het zoeken in MRS (zo beetje alle bekende databanken), 
>>> het BLASTen tegen een query van MRS, en het runnen van clustal.
>>>
>>>  
>>>
>>> http://mrs.cmbi.ru.nl/mrs-wsdl/mrsws_search.wsdl
>>>
>>> http://mrs.cmbi.ru.nl/mrs-wsdl/mrsws_blast.wsdl
>>>
>>> http://mrs.cmbi.ru.nl/mrs-wsdl/mrsws_clustal.wsdl
>>>
>>>  
>>>
>>> Ik ben benieuwd wat je hiervan vindt.
>>>
>>>  
>>>
>>> Groet,
>>>
>>>  
>>>
>>> Marc
>>>
>>>  
>>>
>>> _____________________________________________________
>>>
>>> Marc A. van Driel (PhD)
>>>
>>> Netherlands Bioinformatics Centre
>>>
>>> Coordinator Bioinformatics
>>>
>>>  
>>>
>>> 260 NBIC
>>>
>>> P.O. Box 9101
>>>
>>> 6500 HB  Nijmegen
>>>
>>>  
>>>
>>> Tel. +31 (0)24 36 19500 (NBIC Office)
>>>
>>> Tel. +31 (0)24 36 13306 (Direct)
>>>
>>> Tel. +31 (0)6 24448612 (Mobile)
>>>
>>> Fax. +31 (0)24 36 19395
>>>
>>> E.mail marc.van.driel@nbic.nl <mailto:marc.van.driel@nbic.nl>
>>>
>>> http://www.nbic.nl
>>>
>>> _____________________________________________________
>>>
>>>  
>>>
>>>     
>>
>>   
> 
> -- 
> 
> Marco Roos
> Faculty of Science
> University of Amsterdam
> Kruislaan 403, room F1.02
> 1098 SJ Amsterdam
> tel. +31 (0) 20 525 7522
> http://home.medewerker.uva.nl/m.roos1 (includes links to social networks)
> 


--------------080603050909070902010804
Content-Type: text/xml;
 name="mrs_blast.xml"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="mrs_blast.xml"

<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:net.sf.taverna:wfDefinition:a6242028-e20a-45d4-9111-49377c24a36b" author="" title="mrs_blast" />
  <s:processor name="BlastJobResultParams">
    <s:local>
      org.embl.ebi.escience.scuflworkers.java.XMLInputSplitter
      <s:extensions>
        <s:complextype optional="false" unbounded="false" typename="BlastJobResult" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastJobResult">
          <s:elements>
            <s:basetype optional="false" unbounded="false" typename="string" name="job-id" qname="{http://www.w3.org/2001/XMLSchema}string" />
          </s:elements>
        </s:complextype>
      </s:extensions>
    </s:local>
  </s:processor>
  <s:processor name="Flatten_list">
    <s:local>
      org.embl.ebi.escience.scuflworkers.java.FlattenList
      <s:extensions>
        <s:flattenlist s:depth="2" />
      </s:extensions>
    </s:local>
  </s:processor>
  <s:processor name="BlastJobResultOutputParams">
    <s:local>
      org.embl.ebi.escience.scuflworkers.java.XMLOutputSplitter
      <s:extensions>
        <s:complextype optional="false" unbounded="false" typename="BlastResult" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastResult">
          <s:elements>
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="db-count" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="db-length" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="eff-space" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
            <s:basetype optional="false" unbounded="false" typename="double" name="kappa" qname="{http://www.w3.org/2001/XMLSchema}double" />
            <s:basetype optional="false" unbounded="false" typename="double" name="lambda" qname="{http://www.w3.org/2001/XMLSchema}double" />
            <s:basetype optional="false" unbounded="false" typename="double" name="entropy" qname="{http://www.w3.org/2001/XMLSchema}double" />
            <s:arraytype optional="true" unbounded="true" wrapped="false" typename="Hit" name="hits" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}Hit[0,unbounded]">
              <s:elementtype>
                <s:complextype optional="false" unbounded="false" typename="Hit" name="" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}Hit">
                  <s:elements>
                    <s:basetype optional="false" unbounded="false" typename="string" name="id" qname="{http://www.w3.org/2001/XMLSchema}string" />
                    <s:basetype optional="false" unbounded="false" typename="string" name="title" qname="{http://www.w3.org/2001/XMLSchema}string" />
                    <s:arraytype optional="true" unbounded="true" wrapped="false" typename="Hsp" name="hsps" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}Hsp[0,unbounded]">
                      <s:elementtype>
                        <s:complextype optional="false" unbounded="false" typename="Hsp" name="" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}Hsp">
                          <s:elements>
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="score" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="double" name="bit-score" qname="{http://www.w3.org/2001/XMLSchema}double" />
                            <s:basetype optional="false" unbounded="false" typename="double" name="expect" qname="{http://www.w3.org/2001/XMLSchema}double" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="query-start" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="subject-start" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="identity" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="positive" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="gaps" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="subject-length" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
                            <s:basetype optional="false" unbounded="false" typename="string" name="query-alignment" qname="{http://www.w3.org/2001/XMLSchema}string" />
                            <s:basetype optional="false" unbounded="false" typename="string" name="subject-alignment" qname="{http://www.w3.org/2001/XMLSchema}string" />
                            <s:basetype optional="false" unbounded="false" typename="string" name="midline" qname="{http://www.w3.org/2001/XMLSchema}string" />
                          </s:elements>
                        </s:complextype>
                      </s:elementtype>
                    </s:arraytype>
                  </s:elements>
                </s:complextype>
              </s:elementtype>
            </s:arraytype>
          </s:elements>
        </s:complextype>
      </s:extensions>
    </s:local>
  </s:processor>
  <s:processor name="BlastASyncParams">
    <s:local>
      org.embl.ebi.escience.scuflworkers.java.XMLInputSplitter
      <s:extensions>
        <s:complextype optional="false" unbounded="false" typename="BlastAsync" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastAsync">
          <s:elements>
            <s:basetype optional="false" unbounded="false" typename="string" name="db" qname="{http://www.w3.org/2001/XMLSchema}string" />
            <s:basetype optional="false" unbounded="false" typename="string" name="mrsBooleanQuery" qname="{http://www.w3.org/2001/XMLSchema}string" />
            <s:basetype optional="false" unbounded="false" typename="string" name="query" qname="{http://www.w3.org/2001/XMLSchema}string" />
            <s:basetype optional="false" unbounded="false" typename="string" name="program" qname="{http://www.w3.org/2001/XMLSchema}string" />
            <s:basetype optional="false" unbounded="false" typename="string" name="matrix" qname="{http://www.w3.org/2001/XMLSchema}string" />
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="word-size" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
            <s:basetype optional="false" unbounded="false" typename="double" name="expect" qname="{http://www.w3.org/2001/XMLSchema}double" />
            <s:basetype optional="false" unbounded="false" typename="boolean" name="low-complexity-filter" qname="{http://www.w3.org/2001/XMLSchema}boolean" />
            <s:basetype optional="false" unbounded="false" typename="boolean" name="gapped" qname="{http://www.w3.org/2001/XMLSchema}boolean" />
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="gap-open" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
            <s:basetype optional="false" unbounded="false" typename="unsignedLong" name="gap-extend" qname="{http://www.w3.org/2001/XMLSchema}unsignedLong" />
          </s:elements>
        </s:complextype>
      </s:extensions>
    </s:local>
  </s:processor>
  <s:processor name="BlastASyncOutputParams">
    <s:local>
      org.embl.ebi.escience.scuflworkers.java.XMLOutputSplitter
      <s:extensions>
        <s:complextype optional="false" unbounded="false" typename="BlastAsyncResponse" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastAsyncResponse">
          <s:elements>
            <s:basetype optional="false" unbounded="false" typename="string" name="response" qname="{http://www.w3.org/2001/XMLSchema}string" />
          </s:elements>
        </s:complextype>
      </s:extensions>
    </s:local>
  </s:processor>
  <s:processor name="BlastAsync">
    <s:description>Service definition of function ns__BlastAsync</s:description>
    <s:arbitrarywsdl>
      <s:wsdl>http://mrs.cmbi.ru.nl/mrs/mrsws_blast.wsdl</s:wsdl>
      <s:operation>BlastAsync</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="BlastJobResult">
    <s:description>Service definition of function ns__BlastJobResult</s:description>
    <s:arbitrarywsdl>
      <s:wsdl>http://mrs.cmbi.ru.nl/mrs/mrsws_blast.wsdl</s:wsdl>
      <s:operation>BlastJobResult</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="checkBlastStatus">
    <s:workflow maxretries="30" retrydelay="5000" critical="true">
      <s:scufl version="0.2" log="0">
        <s:workflowdescription lsid="urn:lsid:net.sf.taverna:wfDefinition:6d808ea4-f774-48c5-b38f-134bdbcf3449" author="" title="retry_blast" />
        <s:processor name="BlastJobOutputParams">
          <s:local>
            org.embl.ebi.escience.scuflworkers.java.XMLOutputSplitter
            <s:extensions>
              <s:complextype optional="false" unbounded="false" typename="BlastJobStatusResponse" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastJobStatusResponse">
                <s:elements>
                  <s:complextype optional="false" unbounded="false" typename="JobStatus" name="response" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}JobStatus">
                    <s:elements>
                      <s:basetype optional="false" unbounded="false" typename="string" name="value" qname="{http://www.w3.org/2001/XMLSchema}string" />
                    </s:elements>
                  </s:complextype>
                </s:elements>
              </s:complextype>
            </s:extensions>
          </s:local>
        </s:processor>
        <s:processor name="BlastJobInputParams">
          <s:local>
            org.embl.ebi.escience.scuflworkers.java.XMLInputSplitter
            <s:extensions>
              <s:complextype optional="false" unbounded="false" typename="BlastJobStatus" name="parameters" qname="{http://mrs.cmbi.ru.nl/mrsws-blast}BlastJobStatus">
                <s:elements>
                  <s:basetype optional="false" unbounded="false" typename="string" name="job-id" qname="{http://www.w3.org/2001/XMLSchema}string" />
                </s:elements>
              </s:complextype>
            </s:extensions>
          </s:local>
        </s:processor>
        <s:processor name="Fail_if_false">
          <s:local critical="true">org.embl.ebi.escience.scuflworkers.java.FailIfFalse</s:local>
        </s:processor>
        <s:processor name="checkStatus">
          <s:beanshell>
            <s:scriptvalue>output = "";
input_tmp = input.replaceAll("\\&lt;.*?\\&gt;", "");

if (input_tmp.equals("finished"))
{
	output = "true";
}

else
{
	output = "false";
}</s:scriptvalue>
            <s:beanshellinputlist>
              <s:beanshellinput s:syntactictype="'text/plain'">input</s:beanshellinput>
            </s:beanshellinputlist>
            <s:beanshelloutputlist>
              <s:beanshelloutput s:syntactictype="'text/plain'">output</s:beanshelloutput>
            </s:beanshelloutputlist>
            <s:dependencies s:classloader="iteration" />
          </s:beanshell>
        </s:processor>
        <s:processor name="BlastJobStatus">
          <s:description>Service definition of function ns__BlastJobStatus</s:description>
          <s:arbitrarywsdl>
            <s:wsdl>http://mrs.cmbi.ru.nl/mrs/mrsws_blast.wsdl</s:wsdl>
            <s:operation>BlastJobStatus</s:operation>
          </s:arbitrarywsdl>
        </s:processor>
        <s:link source="BlastJobInputParams:output" sink="BlastJobStatus:parameters" />
        <s:link source="jobId" sink="BlastJobInputParams:job-id" />
        <s:link source="BlastJobOutputParams:response" sink="checkStatus:input" />
        <s:link source="BlastJobStatus:parameters" sink="BlastJobOutputParams:input" />
        <s:link source="checkStatus:output" sink="Fail_if_false:test" />
        <s:source name="jobId" />
      </s:scufl>
    </s:workflow>
  </s:processor>
  <s:link source="BlastASyncOutputParams:response" sink="BlastJobResultParams:job-id" />
  <s:link source="BlastASyncOutputParams:response" sink="checkBlastStatus:jobId" />
  <s:link source="BlastASyncParams:output" sink="BlastAsync:parameters" />
  <s:link source="BlastAsync:parameters" sink="BlastASyncOutputParams:input" />
  <s:link source="BlastJobResult:parameters" sink="BlastJobResultOutputParams:input" />
  <s:link source="BlastJobResultOutputParams:hits" sink="Flatten_list:inputlist" />
  <s:link source="BlastJobResultParams:output" sink="BlastJobResult:parameters" />
  <s:link source="databank" sink="BlastASyncParams:db" />
  <s:link source="sequence" sink="BlastASyncParams:query" />
  <s:link source="Flatten_list:outputlist" sink="hits" />
  <s:source name="sequence" />
  <s:source name="databank" />
  <s:sink name="hits">
    <s:metadata>
      <s:mimeTypes>
        <s:mimeType>text/xml</s:mimeType>
      </s:mimeTypes>
    </s:metadata>
  </s:sink>
  <s:coordination name="BlastJobResultParams_BLOCKON_Nested_Workflow">
    <s:condition>
      <s:state>Completed</s:state>
      <s:target>checkBlastStatus</s:target>
    </s:condition>
    <s:action>
      <s:target>BlastJobResultParams</s:target>
      <s:statechange>
        <s:from>Scheduled</s:from>
        <s:to>Running</s:to>
      </s:statechange>
    </s:action>
  </s:coordination>
</s:scufl>


--------------080603050909070902010804--
